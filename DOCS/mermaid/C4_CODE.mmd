---
title: PoDebateRap - Code Diagram (C4 Level 4)
---
C4Component
    title Code Diagram - DebateOrchestrator Internal Structure

    Container_Boundary(orchestrator, "DebateOrchestrator") {
        Component(stateFactory, "DebateStateFactory", "Factory", "Creates and initializes DebateState objects with default values")
        Component(currentState, "CurrentState", "Property", "Holds the current DebateState with all turn data")
        Component(startDebate, "StartNewDebateAsync", "Method", "Initializes debate with rappers, topic, begins turn loop")
        Component(generateTurn, "GenerateTurnAsync", "Method", "Generates verse via AI, converts to audio, broadcasts")
        Component(judgDebate, "JudgeDebateAsync", "Method", "AI judges all verses, determines winner, updates leaderboard")
        Component(signalAudio, "SignalAudioPlaybackCompleteAsync", "Method", "Signals audio done, triggers next turn or judging")
        Component(resetDebate, "ResetDebate", "Method", "Clears state for new debate")
    }

    Container_Boundary(state, "DebateState Model") {
        Component(debateId, "DebateId", "Property", "Unique identifier for the debate session")
        Component(rappers, "Rapper1/Rapper2", "Properties", "The two competing rapper profiles")
        Component(topic, "Topic", "Property", "The debate topic being discussed")
        Component(turnData, "CurrentTurnNumber/TotalTurns", "Properties", "Turn tracking (1-10)")
        Component(turnText, "CurrentTurnText", "Property", "Current verse being displayed")
        Component(history, "TurnHistory", "Property", "List of all completed turns with verses")
        Component(flags, "IsDebateInProgress/IsComplete", "Properties", "State flags for UI")
        Component(winner, "WinnerName/JudgeReasoning", "Properties", "Final judgment results")
    }

    Rel(startDebate, stateFactory, "Creates initial state")
    Rel(startDebate, generateTurn, "Begins turn loop")
    Rel(generateTurn, currentState, "Updates turn text")
    Rel(signalAudio, generateTurn, "Triggers next turn")
    Rel(signalAudio, judgDebate, "Triggers when all turns done")
    Rel(judgDebate, currentState, "Sets winner")
    Rel(resetDebate, stateFactory, "Creates fresh state")

    UpdateLayoutConfig($c4ShapeInRow="4", $c4BoundaryInRow="2")
